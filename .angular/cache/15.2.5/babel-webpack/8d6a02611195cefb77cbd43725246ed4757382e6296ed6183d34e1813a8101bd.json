{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../auth-service.service\";\nimport * as i2 from \"../token-storage.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction LoginComponent_form_10_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \" Username is required! \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_10_div_19_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Password is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_10_div_19_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Password must be at least 6 characters \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_10_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtemplate(1, LoginComponent_form_10_div_19_div_1_Template, 2, 0, \"div\", 28);\n    i0.ɵɵtemplate(2, LoginComponent_form_10_div_19_div_2_Template, 2, 0, \"div\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r5 = i0.ɵɵreference(18);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r5 == null ? null : _r5.errors == null ? null : _r5.errors.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r5 == null ? null : _r5.errors == null ? null : _r5.errors.minlength);\n  }\n}\nfunction LoginComponent_form_10_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Login failed: \", ctx_r7.errorMessage, \" \");\n  }\n}\nfunction LoginComponent_form_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 12, 13);\n    i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_form_10_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const _r2 = i0.ɵɵreference(1);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(_r2.form.valid && ctx_r10.onSubmit());\n    });\n    i0.ɵɵelementStart(2, \"div\", 14);\n    i0.ɵɵelement(3, \"i\", 15);\n    i0.ɵɵelementStart(4, \"span\", 16);\n    i0.ɵɵtext(5, \"Logo\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"h5\", 17);\n    i0.ɵɵtext(7, \"Sign into your account\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 18)(9, \"label\", 19);\n    i0.ɵɵtext(10, \"Username\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 20, 21);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_form_10_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.form.username = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, LoginComponent_form_10_div_13_Template, 2, 0, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 18)(15, \"label\", 23);\n    i0.ɵɵtext(16, \"Password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"input\", 24, 25);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_form_10_Template_input_ngModelChange_17_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.form.password = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(19, LoginComponent_form_10_div_19_Template, 3, 2, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"div\", 18)(21, \"button\", 26);\n    i0.ɵɵtext(22, \" Login \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 18);\n    i0.ɵɵtemplate(24, LoginComponent_form_10_div_24_Template, 2, 1, \"div\", 22);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const _r2 = i0.ɵɵreference(1);\n    const _r3 = i0.ɵɵreference(12);\n    const _r5 = i0.ɵɵreference(18);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.form.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r2.submitted && _r3.invalid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.form.password);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r2.submitted && _r5.invalid);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", _r2.submitted && ctx_r0.isLoginFailed);\n  }\n}\nfunction LoginComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Logged in as \", ctx_r1.roles, \". \");\n  }\n}\nexport class LoginComponent {\n  constructor(authService, tokenStorage, router) {\n    this.authService = authService;\n    this.tokenStorage = tokenStorage;\n    this.router = router;\n    this.form = {};\n    this.isLoggedIn = false;\n    this.isLoginFailed = false;\n    this.errorMessage = '';\n    this.roles = [];\n  }\n  ngOnInit() {\n    if (this.tokenStorage.getToken()) {\n      this.isLoggedIn = false;\n      this.roles = this.tokenStorage.getUser().roles;\n    }\n  }\n  onSubmit() {\n    this.authService.login(this.form).subscribe(data => {\n      this.tokenStorage.saveToken(data.accessToken);\n      this.tokenStorage.saveUser(data);\n      this.isLoginFailed = false;\n      this.isLoggedIn = true;\n      this.roles = this.tokenStorage.getUser().roles;\n      this.router.navigateByUrl('/admin');\n    }, err => {\n      this.errorMessage = err.error.message;\n      this.isLoginFailed = true;\n    });\n  }\n  reloadPage() {\n    this.isLoggedIn = false;\n    this.router.navigateByUrl(\"/home\");\n  }\n}\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.TokenStorageService), i0.ɵɵdirectiveInject(i3.Router));\n};\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 12,\n  vars: 2,\n  consts: [[1, \"vh-100\", 2, \"background-color\", \"#fff4f6\"], [1, \"container\", \"py-5\", \"h-100\"], [1, \"row\", \"d-flex\", \"justify-content-center\", \"align-items-center\", \"h-100\"], [1, \"col\", \"col-xl-10\"], [1, \"card\", 2, \"border-radius\", \"1rem\"], [1, \"row\", \"g-0\"], [1, \"col-md-6\", \"col-lg-5\", \"d-none\", \"d-md-block\"], [\"src\", \"https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/img1.webp\", \"alt\", \"login form\", 1, \"img-fluid\", 2, \"border-radius\", \"1rem 0 0 1rem\"], [1, \"col-md-6\", \"col-lg-7\", \"d-flex\", \"align-items-center\"], [1, \"card-body\", \"p-4\", \"p-lg-5\", \"text-black\"], [\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\", 4, \"ngIf\"], [\"class\", \"alert alert-success\", 4, \"ngIf\"], [\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\"], [\"f\", \"ngForm\"], [1, \"d-flex\", \"align-items-center\", \"mb-3\", \"pb-1\"], [1, \"fas\", \"fa-cubes\", \"fa-2x\", \"me-3\", 2, \"color\", \"#ff6219\"], [1, \"h1\", \"fw-bold\", \"mb-0\"], [1, \"fw-normal\", \"mb-3\", \"pb-3\", 2, \"letter-spacing\", \"1px\"], [1, \"form-group\"], [\"for\", \"username\"], [\"type\", \"text\", \"name\", \"username\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"username\", \"ngModel\"], [\"class\", \"alert alert-danger\", \"role\", \"alert\", 4, \"ngIf\"], [\"for\", \"password\"], [\"type\", \"password\", \"name\", \"password\", \"required\", \"\", \"minlength\", \"6\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"password\", \"ngModel\"], [1, \"btn\", \"btn-primary\", \"btn-block\"], [\"role\", \"alert\", 1, \"alert\", \"alert-danger\"], [4, \"ngIf\"], [1, \"alert\", \"alert-success\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"div\", 6);\n      i0.ɵɵelement(7, \"img\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"div\", 8)(9, \"div\", 9);\n      i0.ɵɵtemplate(10, LoginComponent_form_10_Template, 25, 5, \"form\", 10);\n      i0.ɵɵtemplate(11, LoginComponent_div_11_Template, 2, 1, \"div\", 11);\n      i0.ɵɵelementEnd()()()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isLoggedIn);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn);\n    }\n  },\n  dependencies: [i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.MinLengthValidator, i5.NgModel, i5.NgForm],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","ctx_r10","LoginComponent","constructor","authService","tokenStorage","router","ngOnInit","getToken","isLoggedIn","roles","getUser","onSubmit","login","form","subscribe","data","saveToken","accessToken","saveUser","isLoginFailed","navigateByUrl","err","errorMessage","error","message","reloadPage","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\aicha\\Desktop\\pfe\\src\\app\\components\\Authentication\\login\\login.component.html","C:\\Users\\aicha\\Desktop\\pfe\\src\\app\\components\\Authentication\\login\\login.component.ts"],"sourcesContent":["\n<section class=\"vh-100\" style=\"background-color: #fff4f6;\">\n  <div class=\"container py-5 h-100\">\n    <div class=\"row d-flex justify-content-center align-items-center h-100\">\n      <div class=\"col col-xl-10\">\n        <div class=\"card\" style=\"border-radius: 1rem;\">\n          <div class=\"row g-0\">\n            <div class=\"col-md-6 col-lg-5 d-none d-md-block\">\n              <img src=\"https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/img1.webp\"\n                alt=\"login form\" class=\"img-fluid\" style=\"border-radius: 1rem 0 0 1rem;\" />\n            </div>\n            <div class=\"col-md-6 col-lg-7 d-flex align-items-center\">\n              <div class=\"card-body p-4 p-lg-5 text-black\">\n\n                <form\n                *ngIf=\"!isLoggedIn\"\n                name=\"form\"\n                (ngSubmit)=\"f.form.valid && onSubmit()\"\n                #f=\"ngForm\"\n                novalidate\n              >\n              <div class=\"d-flex align-items-center mb-3 pb-1\">\n                <i class=\"fas fa-cubes fa-2x me-3\" style=\"color: #ff6219;\"></i>\n                <span class=\"h1 fw-bold mb-0\">Logo</span>\n              </div>\n\n              <h5 class=\"fw-normal mb-3 pb-3\" style=\"letter-spacing: 1px;\">Sign into your account</h5>\n                <div class=\"form-group\">\n                  <label for=\"username\">Username</label>\n                  <input\n                    type=\"text\"\n                    class=\"form-control\"\n                    name=\"username\"\n                    [(ngModel)]=\"form.username\"\n                    required\n                    #username=\"ngModel\"\n                  />\n                  <div\n                    class=\"alert alert-danger\"\n                    role=\"alert\"\n                    *ngIf=\"f.submitted && username.invalid\"\n                  >\n                    Username is required!\n                  </div>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"password\">Password</label>\n                  <input\n                    type=\"password\"\n                    class=\"form-control\"\n                    name=\"password\"\n                    [(ngModel)]=\"form.password\"\n                    required\n                    minlength=\"6\"\n                    #password=\"ngModel\"\n                  />\n                  <div\n                    class=\"alert alert-danger\"\n                    role=\"alert\"\n                    *ngIf=\"f.submitted && password.invalid\"\n                  >\n                    <div *ngIf=\"password?.errors?.required\">Password is required</div>\n                    <div *ngIf=\"password?.errors?.minlength\">\n                      Password must be at least 6 characters\n                    </div>\n                  </div>\n                </div>\n                <div class=\"form-group\">\n                  <button class=\"btn btn-primary btn-block\">\n                    Login\n                  </button>\n                </div>\n                <div class=\"form-group\">\n                  <div\n                    class=\"alert alert-danger\"\n                    role=\"alert\"\n                    *ngIf=\"f.submitted && isLoginFailed\"\n                  >\n                    Login failed: {{ errorMessage }}\n                  </div>\n                </div>\n              </form>\n          \n              <div class=\"alert alert-success\" *ngIf=\"isLoggedIn\">\n                Logged in as {{ roles }}.\n              </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>\n","import { Component } from '@angular/core';\nimport { AuthService } from '../auth-service.service';\nimport { TokenStorageService } from '../token-storage.service';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})\nexport class LoginComponent {\n  form: any = {};\n  isLoggedIn = false;\n  isLoginFailed = false;\n  errorMessage = '';\n  roles: string[] = [];\n\n  constructor(private authService: AuthService, private tokenStorage: TokenStorageService,private router:Router) { }\n\n  ngOnInit() {\n    if (this.tokenStorage.getToken()) {\n      this.isLoggedIn = false;\n      this.roles = this.tokenStorage.getUser().roles;\n    }\n  }\n\n  onSubmit() {\n    this.authService.login(this.form).subscribe(\n      data => {\n        this.tokenStorage.saveToken(data.accessToken);\n        this.tokenStorage.saveUser(data);\n\n        this.isLoginFailed = false;\n        this.isLoggedIn = true;\n        this.roles = this.tokenStorage.getUser().roles;\n        this.router.navigateByUrl('/admin')\n      },\n      err => {\n        this.errorMessage = err.error.message;\n        this.isLoginFailed = true;\n      }\n    );\n  }\n\n  reloadPage() {\n    this.isLoggedIn=false;\nthis.router.navigateByUrl(\"/home\");\n  }\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}